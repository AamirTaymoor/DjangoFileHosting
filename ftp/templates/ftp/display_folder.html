{% extends "ftp/base.html" %}
{% load static %}
{% block navbar%}
<ul class="navbar-nav  justify-content-center">
  <li class="nav-item justify-content-center">
      <!-- <a class="btn btn-primary" href="{% url 'ftp:upload' pk %}" role="button">Upload File</a> -->
      <a href="{% url 'ftp:upload' pk %}" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" id="upload-file"> Upload File</a>
  </li>
</ul>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel" style="color: blue;">File Upload</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="post" id="upload-form" action="{% url 'ftp:upload' pk %}" enctype="multipart/form-data">
          {% csrf_token %}
          <label for="fileUpload"></label>
          <input type="file" id="fileUpload" name="myfile">

          <button type="submit" class="btn btn-primary" style="background-color: blue;">Upload</button>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal"
          style="background-color: blue;">Cancel</button>
        {% csrf_token %}
      </div>
    </div>
  </div>
</div>

{% endblock %}
{% block content %}
<!-- modal style -->
<style>
  input[type=file]::file-selector-button {
  border: 2px solid #6c5ce7;
  padding: .2em .4em;
  border-radius: .2em;
  background-color:blue;
  transition: 1s;
}

input[type=file]::file-selector-button:hover {
  background-color: #81ecec;
  border: 2px solid #00cec9;
}
</style>

<div class="row">
{% if d %}
{% for i in d %}
<div class="col-xl-3 col-md-6 mb-4">
            
  <div class="card border-left-primary shadow h-100 py-2">
      <a class=" dropdown-toggle" href="#" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color: azure;">
          <i class="fa fa-caret-down fa-3x" style="color: rgb(42, 95, 165);" aria-hidden="true"></i>
      </a>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
          <a href="{% url 'ftp:delete-file' pk=i.id %}" class="dropdown-item text-danger" data-toggle="modal" data-target="#del{{i.id}}" id="delete-item">              
              Delete
          </a>
          <a href="#" class="dropdown-item text-info" data-toggle="modal" data-target="#edit{{i.id}}" id="edit-item">
             Edit Name
          </a>
      </div>
      <div class="card-body">
          <div class="row no-gutters align-items-center">
              <div class="col mr-2">
                      <a href="{{i.file_path}}">
                      {% if i.file_ext == '.txt' %}
                        <i class="fa-solid fa-file" style="font-size: 4rem; color: rgb(111, 111, 206);"></i>
                        {% elif i.file_ext == '.pptx' %}
                        <i class="fas fa-file-powerpoint" style="font-size: 4rem; color: rgb(111, 111, 206);"></i>
                        {% elif i.file_ext == '.csv' %}
                        <i class="fas fa-file-csv" style="font-size: 4rem; color: rgb(111, 111, 206);"></i>
                      {% elif i.file_ext == '.pdf' %}
                      <i class="fa-solid fa-file-pdf" style="font-size: 4rem; color: rgb(111, 111, 206);"></i>
                      {% elif i.file_ext == '.mp4' or i.file_ext == '.mpeg-4' or i.file_ext == '.avi' or i.file_ext == '.mov' or i.file_ext == '.mkv'%}
                      <i class="fas fa-video" style="font-size: 4rem; color: rgb(111, 111, 206);"></i>
                      {% elif i.file_ext == '.jpg' or i.file_ext == '.jpeg' or i.file_ext == '.png' or i.file_ext == '.gif'%}
                      <i class="fas fa-image" style="font-size: 4rem; color: rgb(111, 111, 206);"></i>
                      {% else %}
                        File format not identified
                      {% endif %}
                      </a>
                      <span>
                          {{ i.file_name }}
                      </span>
                    </a>
              </div>
                    <div class="modal fade" id="del{{i.id}}">
                      <div class="modal-dialog">
                        <div class="modal-content">
                          <div class="modal-body">
                            <p>Are you sure, You want to remove this item?</p>
                          </div>
                          <div class="justify-content-between mb-2 mr-2 text-right">
                            <form method="post" id="item-delete-form" action="{% url 'ftp:delete-file' pk=i.id %}">
                              <button type="button" class="btn btn-secondary mr-1" data-dismiss="modal">Cancel</button>
                              {% csrf_token %}
                              <button type="submit" class="btn btn-danger" id="confirm-delete-item-button">Delete</button>
                            </form>
                          </div>
                        </div>
                      </div>
                    </div>
              <div class="col-auto">
                <i class="fas fa-calendar fa-2x text-gray-300"></i>
            </div>
        </div>
    </div>
</div>
</div>

    {% endfor %}      
    {% else %}
        
            <div>No Files </div>
    {% endif %}

        <script>
           $(document).on('click', '#delete-item', () => {
        document.getElementById("item-delete-form").action = document.querySelector('#delete-item').href
        });
       </script>
        


</div>
{% endblock %}